---
description: 提交前进行代码检查和验收
---

# 检查清单: [功能名称]

**规范**: `./spec.md` | **日期**: [YYYY-MM-DD] | **状态**: 🔴未开始/🟡进行中/🟢完成

---

## 执行检查

依次检查以下所有项目：

### 需求检查

- [ ] CHK-01 功能需求(MUST)全部满足
- [ ] CHK-02 边界情况已处理
- [ ] CHK-03 没有遗漏的功能点
- [ ] CHK-04 没有逻辑问题

### 技术检查

- [ ] CHK-05 代码符合 `.cursor/rules/` 项目规范
- [ ] CHK-06 代码符合 `regular.mdc` 通用规范（注释中文、简洁格式）
- [ ] CHK-07 无明显性能问题
- [ ] CHK-08 错误处理完善
- [ ] CHK-09 **弹窗/Drawer 状态重置**：打开后是否正确重置状态，不重置是否会导致数据残留问题

### 🔍 AI 生成代码审查（重点）

> 💡 **借鉴 Sora 团队经验**：重点审查 AI 生成的代码，而非逐行编写

- [ ] CHK-11 **逻辑正确性**：AI 生成的业务逻辑是否符合需求意图
- [ ] CHK-12 **边界处理**：空值、异常输入、极端情况是否处理
- [ ] CHK-13 **代码风格**：是否与项目现有代码风格一致
- [ ] CHK-14 **依赖合理**：新增的依赖是否必要且安全
- [ ] CHK-15 **无冗余代码**：是否有 AI 生成的无用代码或注释

### 交付检查

- [ ] CHK-16 文档已更新（如需要）
- [ ] CHK-17 代码已自查
- [ ] CHK-18 可正常运行

---

## 检查结果

完成检查后，输出检查报告：

```markdown
## 📋 检查报告

| 类别 | 通过 | 未通过 | 总计 |
|------|------|--------|------|
| 需求检查 | [N] | [N] | 4 |
| 技术检查 | [N] | [N] | 5 |
| AI代码审查 | [N] | [N] | 5 |
| 交付检查 | [N] | [N] | 3 |
| **总计** | [N] | [N] | 17 |
```

---

## 问题记录

如有问题，记录在此：

| 问题 | 严重度 | 状态 |
|------|--------|------|
| [描述问题] | 🔴高/🟡中/🟢低 | 待处理/已解决 |

---

## 得出结论

### 判断逻辑：

a. 所有检查项通过 → **可以提交**
b. 有未通过项 → 给出理由，**返回修复**

---

## 更新 History 文档

### 检查 history 目录

检查 `.cursor/commands/k/history/` 目录是否有相关文档。

### 情况 A：已有相关文档 → 增量更新

如果 history 目录中**已有**与本次需求相关的文档，**自动增量更新**：

```
📄 检测到已有 History 文档：[文档名称]
📝 执行增量更新...
```

**增量更新规则**：
1. **流程图可改**：如果流程有变化，直接修改原流程图，保持最新状态
2. **文字精简**：只保留核心关键文字，避免冗长描述
3. **按需新增**：新内容在合适位置新增，不重复已有信息
4. **禁止全覆盖**：不完全删除/覆盖已有内容，保留历史价值

**追加格式**：
```markdown
---

## [YYYY-MM-DD] 更新记录

### 变更内容
- [变更1]
- [变更2]

### 修改文件
- [文件列表]

### 流程图更新
（如有变化）
```

### 情况 B：没有相关文档 → 自动新建

如果 history 目录中**没有**相关文档，**自动新建**：
- 命名格式：`YYYYMMDD-feature-description.md`（全英文，功能描述限5个单词）
- 内容：记录本次需求的流程图和关键变更（全中文）

---

## 📊 流程图模板规范

**⚠️ 强制要求：编写 history 文档的流程图时，必须参考 `.cursor/commands/k/docs/history-flow-template.md`**

根据需求场景，选择最匹配的流程图模板：

| 模板 | 适用场景 | 说明 |
|------|----------|------|
| **模板 A** | 用户操作触发流程 | 用户主动操作后触发数据和 UI 变化的流程 |
| **模板 B** | 数据依赖流程 | 数据来源、依赖关系以及过滤逻辑的流程 |
| **模板 C** | 数据展示流程 | 从数据获取到 UI 显示的完整流程 |

### 选择规则

1. **用户交互类需求** → 优先使用模板 A
   - 如：点击按钮、表单提交、弹窗操作等

2. **数据流/状态管理类需求** → 优先使用模板 B
   - 如：数据源切换、状态同步、响应式更新等

3. **页面加载/数据展示类需求** → 优先使用模板 C
   - 如：列表加载、详情展示、API 调用等

4. **复杂需求** → 可组合使用多个模板

### 流程图编写要求

- 使用 ASCII 字符绘制（参考模板格式）
- 包含关键代码位置（文件名 + 行号）
- 标注状态变化和数据流向
- 中文注释说明每个步骤

### ✂️ 文字精简原则

**⚠️ 强制要求：history 文档只记录核心信息，避免冗长**

| ❌ 避免 | ✅ 推荐 |
|--------|--------|
| 详细描述每个实现细节 | 只写关键步骤和核心逻辑 |
| 大段解释性文字 | 用流程图 + 简短注释 |
| 重复说明已有信息 | 直接引用或跳过 |
| 复制粘贴完整代码 | 只标注文件名 + 行号 |

**文字要求**：
- 每个步骤描述 ≤ 30 字
- 变更说明 ≤ 3 条要点
- 优先用流程图表达，减少纯文字

---

## 完成输出

```
✅ 检查完成

📊 检查结果：[通过/未通过]
📝 问题数量：[N] 个
📁 History 文档：[已更新/已新建/跳过]

🎉 流程完成！可以提交代码。
```

---

## 🏁 流程结束

**本次开发流程全部完成。**

如需开始新的需求，请执行 `/k/spec [需求描述]`
