---
description: 执行任务清单，按步骤实现需求
handoffs: 
  - label: ✅ 进入检查阶段
    agent: k.check
    prompt: 执行代码检查和验收
---

# 任务清单: [功能名称]

## 用户输入

```text
$ARGUMENTS
```

---

## 核心目的

按需求实现代码更新，分步骤执行。

---

## 执行规范

确保代码修改符合项目规范，保持代码质量一致性。

### 通用规范（始终应用）

| 规范文件 | 适用场景 | 路径 |
|----------|----------|------|
| `regular.mdc` | 通用代码规范（注释等） | `.cursor/rules/regular.mdc` |

### 前端代码

| 规范文件 | 适用场景 | 路径 |
|----------|----------|------|
| `react.mdc` | React 组件开发 | `.cursor/rules/react.mdc` |
| `clean-code.mdc` | 通用代码规范 | `.cursor/rules/clean-code.mdc` |

### 规范检查清单

执行任务时，确保：

- [ ] 代码符合 `regular.mdc` 通用规范（注释使用中文，简洁格式）
- [ ] 代码符合 `clean-code.mdc` 规范
- [ ] React 代码符合 `react.mdc` 规范
- [ ] 命名规范一致
- [ ] 无冗余代码
- [ ] 错误处理完善

---

## 执行步骤

### 0. 自动规范分析 (可选)

> ⚠️ **默认不执行**: Skills 智能代理模式默认关闭,需要手动启用

**启用方式**:
- 方式 1: 在执行 task 前运行 `/k/mastery` 获取规范建议
- 方式 2: 在 prompt 中添加 `--with-skills` 启用智能代理

**启用后的效果**:
```markdown
📋 **规范分析结果** (智能代理模式)

**任务类型**: 组件修改
**涉及文件**: components/UserProfile.tsx

**适用规范**:
1. react.mdc (高优先级)
2. clean-code.mdc (中优先级)

**适用 Skills**:
1. react-best-practices (推荐)

**自动生成检查清单**:
- [ ] 组件命名使用 PascalCase
- [ ] Props 类型完整定义
- [ ] 避免内联对象/数组作为依赖
```

**相关命令**: `/k/mastery` - Skills 执行器

---

### 1. 获取任务列表

从上一步的计划中获取步骤规划，按顺序执行。

### 2. 逐步执行

对于每个步骤：

```markdown
### 执行 Step [N]: [步骤名称]

🔄 状态：进行中

**操作内容：**
[具体的代码修改]

✅ 完成
```

### 3. 执行进度追踪

```markdown
## 执行进度

- [x] Step 1: [名称] ✅
- [x] Step 2: [名称] ✅
- [ ] Step 3: [名称] 🔄
- [ ] Step 4: [名称] ⏳
```

---

## 完成条件

所有步骤执行完成后，输出：

```
✅ 任务执行完成

📊 执行统计：
- 完成步骤：[N]/[Total]
- 修改文件：[文件列表]
- 新增文件：[如有]
- 删除文件：[如有]
```

---

## 🔄 确认流转（强制）

**⚠️ 强制要求：任务完成后，必须询问用户确认，禁止自动进入 check 阶段。**

### 必须执行的操作：

**1. 输出任务完成摘要**（见上方完成条件）

**2. 输出确认提示**（必须包含以下内容）：

```
🔄 是否进入 [检查阶段] 进行代码检查？

回复 Y 继续，或提出需要修改的地方
```

**3. 停止并等待用户回复**（禁止自动继续）

### 用户回复后的处理：

- 用户回复 `Y` 或 `是` → 执行 `.cursor/commands/k/check.md`
- 用户有其他意见 → 根据反馈继续修改代码

---

**🚫 禁止行为**：
- 禁止在输出确认提示后自动执行 check
- 禁止跳过确认步骤
